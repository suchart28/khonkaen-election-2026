<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô 11 ‡πÄ‡∏Ç‡∏ï</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f0f2f5; margin: 0; padding: 20px; }
        .header { text-align: center; margin-bottom: 30px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; max-width: 1200px; margin: auto; }
        .card { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border-top: 8px solid; transition: transform 0.2s; }
        .card:hover { transform: translateY(-5px); }
        .area-label { font-size: 0.9rem; color: #666; margin-bottom: 5px; }
        .district-title { font-size: 1.4rem; font-weight: bold; margin: 0 0 10px 0; color: #2c3e50; }
        .party-name { font-size: 1.1rem; color: #444; }
        .vote-count { font-size: 2rem; font-weight: bold; color: #1a73e8; margin: 10px 0; }
        .progress-container { background: #eee; border-radius: 10px; height: 10px; margin-top: 10px; }
        .progress-bar { background: #27ae60; height: 100%; border-radius: 10px; width: 0%; transition: width 0.5s; }
        .update-time { text-align: center; color: #888; font-size: 0.8rem; margin-top: 40px; }
    </style>
</head>
<body>

<div class="header">
    <h1>üó≥Ô∏è ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô 11 ‡πÄ‡∏Ç‡∏ï (Real-time)</h1>
    <p>‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡∏à‡∏≤‡∏Å‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•</p>
</div>

<div id="dashboard" class="grid">
    <p style="text-align: center; grid-column: 1/-1;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î...</p>
</div>

<p class="update-time" id="last-sync"></p>

<script>
    // *** ‡∏ô‡∏≥ URL ‡∏ó‡∏µ‡πà Copy ‡∏°‡∏≤‡∏à‡∏≤‡∏Å Google Sheets ‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ***
    const sheet_url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR-U13eCHZLz7sBikTEuqJf6olHfVBi79LC3j6OWdp-WnAqBbRllssoVzS_-DQNGHu_3IvgUw2KRYGH/pub?gid=557174576&single=true&output=csv';

    function fetchData() {
        Papa.parse(sheet_url, {
            download: true,
            header: true,
            complete: function(results) {
                renderCards(results.data);
                document.getElementById('last-sync').innerText = "‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠: " + new Date().toLocaleTimeString();
            }
        });
    }

    function renderCards(data) {
        const container = document.getElementById('dashboard');
        container.innerHTML = '';

        data.forEach(item => {
            if(!item['‡πÄ‡∏Ç‡∏ï']) return;

            const card = document.createElement('div');
            card.className = 'card';
            card.style.borderTopColor = item['‡∏™‡∏µ‡∏û‡∏£‡∏£‡∏Ñ (Hex Code)'] || '#ccc';

            card.innerHTML = `
                <div class="area-label">‡πÄ‡∏Ç‡∏ï‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà ${item['‡πÄ‡∏Ç‡∏ï']}</div>
                <div class="district-title">${item['‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠']}</div>
                <div class="party-name">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 1: <strong>${item['‡∏û‡∏£‡∏£‡∏Ñ‡∏ó‡∏µ‡πà‡∏ô‡∏≥'] || '‡∏£‡∏≠‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô'}</strong></div>
                <div class="vote-count">${Number(item['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 1']).toLocaleString()} <span style="font-size: 1rem;">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</span></div>
                <div style="font-size: 0.8rem; color: #666;">‡∏ô‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß: ${item['‡∏ô‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß (%)']}</div>
                <div class="progress-container">
                    <div class="progress-bar" style="width: ${item['‡∏ô‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß (%)']}"></div>
                </div>
            `;
            container.appendChild(card);
        });
    }

    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å 1 ‡∏ô‡∏≤‡∏ó‡∏µ
    fetchData();
    setInterval(fetchData, 60000);
</script>

</body>
</html>
